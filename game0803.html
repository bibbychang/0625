<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>大富翁遊戲畫面</title>
  <style>
    body { font-family: sans-serif; }
    .grid { display: grid; grid-template-columns: repeat(8, 50px); grid-template-rows: repeat(8, 50px); gap: 2px; margin-bottom: 20px; }
    .cell { width: 50px; height: 50px; border: 1px solid #ccc; background-size: cover; background-position: center; position: relative; }
    .player { width: 20px; height: 20px; border-radius: 50%; position: absolute; bottom: 2px; right: 2px; }
    .p1 { background-color: red; }
    .p2 { background-color: blue; }
    .p3 { background-color: green; }
    .p4 { background-color: orange; }
  </style>
</head>
<body>
  <h1>大富翁遊戲進行中</h1>
  <div id="game-info"></div>
  <div class="grid" id="game-board"></div>

  <script>
    const board = document.getElementById("game-board");
    const gameInfo = document.getElementById("game-info");
    const settings = JSON.parse(localStorage.getItem("gameSettings"));

    const playerCount = parseInt(settings.players);
    const mapData = settings.map;
    const mode = settings.mode;
    const modeValue = settings.modeValue;

    const players = [];
    const positions = Array(playerCount).fill(0);

    function initGame() {
      for (let i = 0; i < 64; i++) {
        const cell = document.createElement("div");
        cell.className = "cell";
        if (mapData[i]) {
          cell.style.backgroundImage = `url(${mapData[i]})`;
        }
        board.appendChild(cell);
      }

      for (let i = 0; i < playerCount; i++) {
        players.push({ id: i, element: createPlayer(i) });
        placePlayer(i, 0);
      }

      gameInfo.innerHTML = `<p>模式：${mode === 'timer' ? '計時制' : '記分制'} (${modeValue})，玩家人數：${playerCount}</p>`;
    }

    function createPlayer(index) {
      const div = document.createElement("div");
      div.className = `player p${index + 1}`;
      return div;
    }

    function placePlayer(playerIndex, position) {
      const cells = board.children;
      for (let cell of cells) cell.querySelector(`.p${playerIndex + 1}`)?.remove();
      const cell = cells[position];
      cell.appendChild(players[playerIndex].element);
    }

    // 實作擲骰與移動功能可加入這裡

    initGame();
  </script>
</body>
</html>
